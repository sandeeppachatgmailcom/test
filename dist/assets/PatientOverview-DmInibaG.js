import{K as ue,r as l,a as pe,b as fe,u as be,c as U,j as e,Q as me,G,R as we,T as ye,D as C,A as j,B as I,H as V,U as je,V as g,W as B,X as q,_ as ve}from"./index-Bp26y0Cv.js";import{T as Ne}from"./index-DtERBddw.js";import{w as ke}from"./warning-Dl0QtHKe.js";const Se=async s=>{try{const u=localStorage.getItem("KOSMO_client_token"),p=localStorage.getItem("KOSMO_client_clientId");if(!u||!p||!(s!=null&&s.patientId))throw new Error("Missing required data for API call.");return(await ue.get(`http://localhost:8089/api/client/bu/caseSheet/getActiveCaseSheetOverView/${p}/${s.patientId}`,{headers:{Authorization:`Bearer ${u}`}})).data}catch(u){throw console.error("Error fetching active case sheet by patient:",u),u}};function Oe({noFade:s,scrollContent:u}){const p=l.useRef(null),v=je(),J=v("calender"),Q=v("pdf"),W=v("singleSearch"),f=pe(),b=fe(),[N]=be(),[X,D]=l.useState(!1),[Z,r]=l.useState(!1),[k,ee]=l.useState({}),[te,Ce]=l.useState(!1),[m,S]=l.useState(null);l.useState([]);const{patientDetail:o,hasData:Ie}=U(t=>t==null?void 0:t.currentPatientSlice);U(t=>t);const[ae,T]=l.useState(!1),[O,A]=l.useState(!1),_=l.useRef(null),w=l.useRef(null),M=t=>{_.current&&!_.current.contains(t.target)&&w.current&&!w.current.contains(t.target)&&T(!1)};l.useEffect(()=>(document.addEventListener("mousedown",M),()=>{document.removeEventListener("mousedown",M)}),[]);const R=[{title:"Step 1",content:"This is the content for step 1."},{title:"Step 2",content:"This is the content for step 2."},{title:"Step 3",content:"This is the content for step 3."},{title:"Step 4",content:"This is the content for step 4."}],se=async()=>{try{const t=await Se({branchId:o==null?void 0:o.branch,patientId:o==null?void 0:o._id});ee(t.data),console.log(t)}catch{}};l.useEffect(()=>{console.log("------------------"),se()},[]),l.useEffect(()=>{async function t(){var a,n,i,d;try{const c={patientId:o==null?void 0:o._id};r(!0);const h=await g.checkOngoingCaseSheet(c);if((n=(a=h==null?void 0:h.data)==null?void 0:a.data)!=null&&n.ongoing){const x=(d=(i=h==null?void 0:h.data)==null?void 0:i.data)==null?void 0:d.cases[0]._id;S(x),r(!1)}else S(null),r(!1)}catch(c){r(!1),console.log("error while checking on going case sheet",c)}}o&&t()},[o]),l.useEffect(()=>{const t=a=>{p.current&&!p.current.contains(a.target)&&w.current&&!w.current.contains(a.target)&&A(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]);async function re(t,a){try{if(t&&a){r(!0);const n=await g.getParticularCaseSheet(a);b(B(n==null?void 0:n.data)),r(!1),f("/patientDetail/createCaseSheet")}}catch{r(!1)}}async function le(t){try{if(t!=null&&t._id){console.log("222"),r(!0);const a=await g.getParticularCaseSheet(t==null?void 0:t._id);console.log("get particular case sheet",a==null?void 0:a.data),b(B(a==null?void 0:a.data)),r(!1),f("/patientDetail/treatment")}}catch(a){r(!1),console.log("error while getting the treatment plan",a)}}const[P,ce]=l.useState({}),ne=t=>{ce(a=>({...a,[t]:!a[t]}))};async function oe(){var t,a,n,i;try{const d={patientId:o==null?void 0:o._id};r(!0);const c=await g.checkOngoingCaseSheet(d);if((a=(t=c==null?void 0:c.data)==null?void 0:t.data)!=null&&a.ongoing){const h=(i=(n=c==null?void 0:c.data)==null?void 0:n.data)==null?void 0:i.cases[0]._id;S(h),r(!1),D(!0)}else r(!1),S(null),b(q()),f("/patientDetail/createCaseSheet")}catch(d){console.log("error while checking on going case sheet",d)}}async function de(){var t,a,n,i;try{const d={patientId:o==null?void 0:o._id};r(!0);const c=await g.checkOngoingCaseSheet(d);if((a=(t=c==null?void 0:c.data)==null?void 0:t.data)!=null&&a.ongoing){const h=(i=(n=c==null?void 0:c.data)==null?void 0:n.data)==null?void 0:i.cases[0]._id,x=await g.getParticularCaseSheet(h);b(B(x==null?void 0:x.data)),r(!1),f("/patientDetail/treatment")}else r(!1),ve.error("There is not case sheet to resume")}catch(d){console.log("error while checking on going case sheet for resume case sheet",d)}}async function ie(){try{if(m){r(!0);const t=await g.getParticularCaseSheet(m);b(B(t==null?void 0:t.data)),r(!1),y(),f("/patientDetail/treatment")}else r(!1),y()}catch(t){console.log("error while resuming the case sheet",t)}}async function he(){try{if(m){r(!0);const t={caseSheetId:m},a=await g.markedAsComplete(t);b(q()),r(!1),y(),f("/patientDetail/createCaseSheet")}else r(!1),y()}catch(t){console.log("error while resuming the case sheet",t)}}const y=()=>{D(!1)},xe=()=>{r(!1)};function ge(t){const a=new Date(t),n=String(a.getDate()).padStart(2,"0"),i=String(a.getMonth()+1).padStart(2,"0"),d=a.getFullYear();return`${n}/${i}/${d}`}return e.jsx(e.Fragment,{children:e.jsxs("div",{className:`md:container  md:mx-auto px-4 py-2 w-full lg:h-screen h-auto flex flex-col lg:flex-row items-center rounded-lg border-[1px]  border-lightBorderColor dark:border-darkSecondary ${N?"bg-darkAccent":"bg-white"}`,children:[e.jsxs("div",{className:" w-[100%] lg:w-[50%] border-[1px] dark:border-cyan-900 dark:border-opacity-25 border-lightBorderColor  h-[27rem] lg:h-[100%]  lg:mr-4 shadow-sm rounded-lg overflow-hidden lg:mt-4 mb-4",children:[e.jsx("div",{className:"px-7 flex items-center border-0 pt-8",children:e.jsx("h3",{children:e.jsx("span",{className:"font-bold text-xl mb-2 dark:text-white text-gray-900",children:"Activities"})})}),e.jsx("div",{className:"px-7 flex items-center border-0 mt-5 mb-0",children:e.jsx("p",{children:e.jsx("span",{className:"text-info font-bold text-2xl",children:"Jul, 22 2024"})})}),e.jsx("div",{className:"px-8 py-4 w-[100%] lg:w-96 h-full overflow-y-auto",children:e.jsx("div",{className:"flex flex-col space-y-5",children:R.map((t,a)=>e.jsxs("div",{className:"flex  gap-2  items-center relative",children:[e.jsx("div",{className:"font-semibold text-gray-600",children:t.title}),a!==R.length-1&&e.jsx("div",{className:"absolute left-[4.5rem] top-8 w-px h-full bg-gray-300"}),e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full border-2 ${a===0?"border-blue-500 bg-blue-500 text-white":"border-gray-300 bg-white text-gray-600"}`}),e.jsx("div",{className:"",children:e.jsx("div",{className:" text-gray-500",children:t.content})})]},a))})})]}),e.jsxs("div",{className:"flex flex-col mx-auto border-[1px] dark:border-darkSecondary border-lightBorderColor  rounded-lg px-8 w-[100%] lg:w-[60%] xl:w-[68%] lg:h-[100%] h-[27rem] ",children:[e.jsxs("div",{className:" relative flex flex-row flex-wrap w-auto justify-between items-center py-7  h-auto",children:[e.jsx("h1",{className:"font-semibold text-xl",children:"Overview"}),e.jsxs("div",{className:" flex gap-2",children:[e.jsx("span",{className:"relative",children:e.jsxs("button",{ref:w,onClick:()=>T(!ae),type:"button",className:"btn btn-sm flex items-center px-4 py-2 bg-lightBgBtn  dark:hover:bg-darkBtnHover text-lightBtntext hover:bg-lightBtntext hover:text-white dark:bg-darkBtn dark:text-white rounded-md",children:[e.jsx(J,{className:"text-lg mr-1"}),"Shedule"]})}),e.jsx("span",{children:e.jsxs("button",{ref:w,onClick:()=>A(!O),className:" btn btn-sm flex items-center px-4 py-2 rounded-md bg-lightBgBtn dark:hover:bg-darkBtnHover text-lightBtntext hover:bg-lightBtntext hover:text-white dark:bg-darkBtn dark:text-white ",children:[e.jsx(Q,{className:"text-lg mr-1"}),"Start"]})}),e.jsxs("span",{className:"relative  z-10  ",children:[e.jsx("span",{className:"absolute top-0 bottom-0 left-3 flex items-center",children:e.jsx(W,{className:`${N?"bg-darkIconAndSearchBg":"bg-light"}`,style:{color:"#80808f"}})}),e.jsx("input",{type:"text",className:"pl-9 py-2 w-[9.4rem] dark:bg-darkIconAndSearchBg bg-light rounded-md",placeholder:"Search ..."})]})]}),O?e.jsx("div",{ref:p,className:`absolute z-50 ${m?"top-[-4.6rem]":"top-[-2rem]"}   right-[-2rem]`,children:e.jsx("div",{className:"",children:e.jsx("div",{className:" w-[17.2rem] h-[100%] shadow-lg border border-lightborderInputColor dark:border-darkSecondary rounded-lg bg-white dark:bg-darkBtn",children:e.jsx("div",{className:"grid grid-cols-1",children:e.jsxs("div",{className:"border-t  border-lightborderInputColor   dark:border-darkSecondary",children:[e.jsx("button",{onClick:oe,className:"  px-3 py-1  w-[100%] relative cursor-pointer",children:e.jsxs("div",{className:"flex py-2 flex-row items-center gap-2 rounded-lg px-2 hover:bg-lightBgBtn dark:hover:bg-lightBtntext dark:hover:text-white",children:[e.jsx("span",{className:"",children:e.jsx(Ne,{className:"  text-xl text-gray-700 dark:text-white"})}),e.jsx("p",{className:` ${N?"text-white":"text-black"}`,children:"New Case Sheet"})]})}),m?e.jsx("button",{onClick:de,className:"  px-3 py-1  w-[100%] relative cursor-pointer",children:e.jsxs("div",{className:"flex flex-row items-center gap-2 px-2 py-2 rounded-lg hover:bg-lightBgBtn dark:hover:bg-lightBtntext dark:hover:text-white ",children:[e.jsx("span",{className:"",children:e.jsx(me,{className:"  text-xl text-gray-700 dark:text-white"})}),e.jsx("p",{className:` ${N?"text-white":"text-black"}`,children:"Resume Last Case Sheet"})]})}):""]})})})})}):""]}),e.jsx("div",{className:"overflow-x-scroll",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-[#C9FEFF] dark:bg-darkBtn dark:text-white sticky top-0",children:e.jsxs("tr",{className:"border-b border-dashed border-lighttableBorderColor",children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-semibold  tracking-wider",children:"Duty Doctor"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-semibold  tracking-wider",children:"Chair"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-semibold  tracking-wider",children:"AppointMent Details"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-semibold  tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-semibold  tracking-wider",children:"Action"})]})}),te?e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 h-[10rem] py-4 text-center text-sm font-medium text-gray-500 dark:text-white",children:e.jsx(G,{})})})}):e.jsx("tbody",{className:"bg-white dark:bg-darkAccent",children:(k==null?void 0:k.length)>0?k.map((t,a)=>{var c,h,x,E,$,L,Y,z,H,F,K;const n=t==null?void 0:t.status;(c=t==null?void 0:t.patientId)==null||c.displayId;const i=t==null?void 0:t.drafted;let d=!1;return(n=="Completed"||i)&&(d=!0),e.jsxs(we.Fragment,{children:[e.jsxs("tr",{className:"border-b border-dashed border-lighttableBorderColor",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-start text-sm text-tableTextColor dark:text-white",children:((E=(x=(h=t==null?void 0:t.dutyDoctorId)==null?void 0:h.firstName)==null?void 0:x.charAt(0))==null?void 0:E.toUpperCase())+((L=($=t==null?void 0:t.dutyDoctorId)==null?void 0:$.firstName)==null?void 0:L.slice(1).toLowerCase())}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm text-tableTextColor dark:text-white",children:(Y=t==null?void 0:t.chairId)==null?void 0:Y.chairNumber}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm text-tableTextColor dark:text-white",children:e.jsxs("div",{className:" flex flex-col h-full",children:[(z=t==null?void 0:t.date)==null?void 0:z.split("T")[0],t!=null&&t.startFrom?ye(t==null?void 0:t.startFrom):""]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm text-tableTextColor dark:text-white",children:e.jsx("span",{className:`cursor-pointer px-2 py-1 rounded-md h-10 w-20 shadow-lg ${(()=>{switch(n){case"In-Progress":return"bg-yellow-900 bg-opacity-50 text-yellow-900";case"Scheduled":return"bg-green-800  bg-opacity-50 text-green-800";case"Cancelled":return"bg-red-800 text-red bg-opacity-50 ";case"Completed":return"bg-green-800 text-white";case"Proposed":return"bg-yellow-900 bg-opacity-50 text-yellow-900";case"ChairReady":return"bg-gray-800 text-gray-800";default:return"bg-gray-300 text-black"}})()}`,onClick:()=>re(i,t==null?void 0:t._id),children:i?"Drafted":t==null?void 0:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm text-tableTextColor",children:e.jsxs("div",{className:"flex justify-center text-lg space-x-5 rtl:space-x-reverse",children:[e.jsx("button",{className:"action-btn",type:"button",disabled:d,onClick:()=>ne(t==null?void 0:t._id),children:e.jsx(C,{icon:P[t==null?void 0:t._id]?"heroicons:chevron-double-up":"heroicons:chevron-double-down"})}),e.jsx("button",{className:"action-btn",type:"button",children:e.jsx(C,{icon:"heroicons:ellipsis-vertical"})})]})})]}),P[t==null?void 0:t._id]&&e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"p-4",children:e.jsx("div",{className:"bg-gray-100 dark:bg-darkSecondary p-1 rounded",children:e.jsx("table",{className:"min-w-full",children:e.jsx("tbody",{children:e.jsx("tr",{className:"",children:e.jsxs("td",{colSpan:"3",className:"px-4 py-2 text-sm flex justify-evenly ",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:(t==null?void 0:t.caseSheetId)&&((H=t==null?void 0:t.caseSheetId)==null?void 0:H.displayId)&&((F=t==null?void 0:t.caseSheetId)==null?void 0:F.displayId)}),e.jsxs("span",{children:["  ",t!=null&&t.caseSheetId?` ${ge((K=t==null?void 0:t.caseSheetId)==null?void 0:K.createdAt)}-Present`:"NO Data To Display"," "]})]}),t!=null&&t.caseSheetId?e.jsxs("button",{disabled:!(t!=null&&t.caseSheetId),className:"action-btn flex items-center gap-1",type:"button",onClick:()=>le(t==null?void 0:t.caseSheetId),children:[e.jsx(C,{className:"text-lightBtntext dark:text-lightBtntext text-[1.5rem] ",icon:"heroicons:forward"}),"Resume"]}):""]})})})})})})})]},a)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 h-[3rem] py-4 text-center text-lg font-medium text-lightModalHeaderColor",children:"NO DATA FOUND"})})})]})})]}),e.jsx(j,{appear:!0,show:X,as:l.Fragment,children:e.jsxs(I,{as:"div",className:"relative z-[99999]",onClose:y,children:[e.jsx(j.Child,{as:l.Fragment,enter:s?"":"duration-300 ease-out",enterFrom:s?"":"opacity-0",enterTo:s?"":"opacity-100",leave:s?"":"duration-200 ease-in",leaveFrom:s?"":"opacity-100",leaveTo:s?"":"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-slate-900/50 backdrop-filter backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:`flex min-h-full w-auto justify-center text-center p-6 items-center "
                                    }`,children:e.jsx(j.Child,{as:l.Fragment,enter:s?"":"duration-300  ease-out",enterFrom:s?"":"opacity-0 scale-95",enterTo:s?"":"opacity-100 scale-100",leave:s?"":"duration-200 ease-in",leaveFrom:s?"":"opacity-100 scale-100",leaveTo:s?"":"opacity-0 scale-95",children:e.jsxs(I.Panel,{className:`w-auto transform overflow-hidden rounded-md
                                       bg-white dark:bg-darkSecondary text-left align-middle shadow-xl transition-alll  h-auto `,children:[e.jsx("div",{className:"relative overflow-hidden py-4 px-5 text-lightModalHeaderColor flex justify-end bg-white border-b border-lightBorderColor dark:bg-darkSecondary dark:border-b dark:border-darkSecondary ",children:e.jsx("button",{onClick:y,className:" text-lightmodalCrosscolor hover:bg-red-100 hover:text-lightmodalbtnText text-[22px]",children:e.jsx(C,{icon:"heroicons-outline:x"})})}),e.jsxs("div",{className:"flex flex-col justify-center mt-20 items-center gap-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{children:e.jsx("img",{className:" mx-auto",src:ke,alt:""})}),e.jsx("div",{children:e.jsx("h1",{className:"text-lightBtntext text-xl pt-3",children:"Are You Sure?"})}),e.jsx("p",{className:"px-10 py-5 tex-lg dark:text-white",children:"You have an open case sheet, are you sure to close it and create a new one?"})]}),e.jsx("div",{className:"px-2 py-3 flex w-[100%] items-center  space-x-3 border-t border-slate-100 dark:border-darkSecondary",children:e.jsxs("div",{className:"flex py-5  w-[100%] justify-around gap-2",children:[e.jsx(V,{text:"Create Case Sheet",className:"btn btn-sm bg-blue-200 hover:bg-blue-500 mt-1 md:mt-2 px-4 py-2 rounded text-blue-900 hover:text-white",onClick:he}),e.jsx(V,{text:"Resume Case Sheet",className:"btn btn-sm bg-lightBgBtn hover:bg-lightHoverBgBtn mt-1 md:mt-2 px-4 py-2 rounded text-lightBtntext hover:text-white",onClick:ie})]})})]})]})})})})]})}),e.jsx(j,{appear:!0,show:Z,as:l.Fragment,children:e.jsxs(I,{as:"div",className:"relative z-[99999]",onClose:xe,children:[e.jsx(j.Child,{as:l.Fragment,enter:s?"":"duration-300 ease-out",enterFrom:s?"":"opacity-0",enterTo:s?"":"opacity-100",leave:s?"":"duration-200 ease-in",leaveFrom:s?"":"opacity-100",leaveTo:s?"":"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-slate-900/50 backdrop-filter backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:`flex min-h-full justify-center text-center p-6 items-center "
                                    }`,children:e.jsx(j.Child,{as:l.Fragment,enter:s?"":"duration-300  ease-out",enterFrom:s?"":"opacity-0 scale-95",enterTo:s?"":"opacity-100 scale-100",leave:s?"":"duration-200 ease-in",leaveFrom:s?"":"opacity-100 scale-100",leaveTo:s?"":"opacity-0 scale-95",children:e.jsx(I.Panel,{className:`w-full transform overflow-hidden rounded-md
                                       bg-white dark:bg-darkSecondary text-left align-middle shadow-xl transition-alll max-w-[17rem] h-40 `,children:e.jsx("div",{className:"flex flex-col justify-center mt-20 items-center gap-2",children:e.jsx(G,{})})})})})})]})})]})})}export{Oe as default};
