import{r as n,u as ie,a as de,b as he,c as xe,V as x,j as e,F as ue,Q as ge,G,Z as v,D as j,A as w,B as C,H as V,U as pe,W as y,aa as fe,X as U,_ as me}from"./index-Bp26y0Cv.js";import{w as be}from"./warning-Dl0QtHKe.js";import{T as we}from"./index-DtERBddw.js";function Se({noFade:l,scrollContent:ye}){const I=pe(),F=I("calender"),W=I("pdf"),[T,P]=n.useState(!1),[f,k]=n.useState(null),[Y,O]=n.useState(!1),N=n.useRef(null),m=()=>{O(!1)},[S,je]=ie(),g=de(),p=he(),[B,q]=n.useState([]),[Q,D]=n.useState(!1),{patientDetail:o,hasData:ke}=xe(t=>t==null?void 0:t.currentPatientSlice);n.useEffect(()=>{A()},[]);async function A(){var t;try{D(!0);const a=await x.getAllCasesOfPatient(o==null?void 0:o._id);q((t=a==null?void 0:a.data)==null?void 0:t.caseSheets),D(!1)}catch(a){D(!1),console.log("error while getting the case sheet",a)}}const[X,r]=n.useState(!1),Z=()=>{r(!1)},[J,_]=n.useState(!1),E=n.useRef(null),b=n.useRef(null),L=t=>{E.current&&!E.current.contains(t.target)&&b.current&&!b.current.contains(t.target)&&_(!1)};n.useEffect(()=>(document.addEventListener("mousedown",L),()=>{document.removeEventListener("mousedown",L)}),[]);async function K(t,a){try{if(a){r(!0);const s=await x.getParticularCaseSheet(a);p(y(s==null?void 0:s.data)),r(!1),g("/patientDetail/viewCaseSheet")}}catch(s){r(!1),console.log("error in view particular case sheet",s)}}async function ee(t,a){try{if(a){r(!0);const s=await x.getCaseDetail(a);p(y(s==null?void 0:s.data)),r(!1),g("/patientDetail/viewCaseDetails")}}catch(s){r(!1),console.log("error in view particular case sheet",s)}}async function te(t){fe.fire({title:`Are you Sure Want to Delete ${t==null?void 0:t.displayId} Case?`,icon:"error",showCloseButton:!0,showCancelButton:!0}).then(a=>{a.isConfirmed&&ae(t==null?void 0:t._id)})}async function ae(t){try{if(t){r(!0);const a=await x.deleteParticularCaseSheet(t);A(),r(!1)}}catch(a){r(!1),console.log("error in deleting particular case sheet",a)}}async function se(t,a){try{if(a){r(!0);const s=await x.getParticularCaseSheet(a);p(y(s==null?void 0:s.data)),r(!1),g("/patientDetail/updateCaseSheet",{state:{id:a}})}}catch(s){r(!1),console.log("error in view particular case sheet",s)}}async function re(t,a){try{if(t&&a){r(!0);const s=await x.getParticularCaseSheet(a);p(y(s==null?void 0:s.data)),r(!1),g("/patientDetail/createCaseSheet")}}catch{r(!1)}}n.useEffect(()=>{const t=a=>{N.current&&!N.current.contains(a.target)&&b.current&&!b.current.contains(a.target)&&P(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]),n.useEffect(()=>{async function t(){var a,s,u,i;try{const c={patientId:o==null?void 0:o._id};r(!0);const d=await x.checkOngoingCaseSheet(c);if((s=(a=d==null?void 0:d.data)==null?void 0:a.data)!=null&&s.ongoing){const h=(i=(u=d==null?void 0:d.data)==null?void 0:u.data)==null?void 0:i.cases[0]._id;k(h),r(!1)}else k(null),r(!1)}catch(c){r(!1),console.log("error while checking on going case sheet",c)}}o&&t()},[o]);async function le(){var t,a,s,u;try{const i={patientId:o==null?void 0:o._id};r(!0);const c=await x.checkOngoingCaseSheet(i);if((a=(t=c==null?void 0:c.data)==null?void 0:t.data)!=null&&a.ongoing){const d=(u=(s=c==null?void 0:c.data)==null?void 0:s.data)==null?void 0:u.cases[0]._id;k(d),r(!1),O(!0)}else r(!1),k(null),p(U()),g("/patientDetail/createCaseSheet")}catch(i){console.log("error while checking on going case sheet",i)}}async function ne(){var t,a,s,u;try{const i={patientId:o==null?void 0:o._id};r(!0);const c=await x.checkOngoingCaseSheet(i);if((a=(t=c==null?void 0:c.data)==null?void 0:t.data)!=null&&a.ongoing){const d=(u=(s=c==null?void 0:c.data)==null?void 0:s.data)==null?void 0:u.cases[0]._id,h=await x.getParticularCaseSheet(d);p(y(h==null?void 0:h.data)),r(!1),g("/patientDetail/treatment")}else r(!1),me.error("There is not case sheet to resume")}catch(i){console.log("error while checking on going case sheet for resume case sheet",i)}}async function ce(){try{if(f){r(!0);const t={caseSheetId:f},a=await x.markedAsComplete(t);p(U()),r(!1),m(),g("/patientDetail/createCaseSheet")}else r(!1),m()}catch(t){console.log("error while resuming the case sheet",t)}}async function oe(){try{if(f){r(!0);const t=await x.getParticularCaseSheet(f);p(y(t==null?void 0:t.data)),r(!1),m(),g("/patientDetail/treatment")}else r(!1),m()}catch(t){console.log("error while resuming the case sheet",t)}}return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"md:container md:mx-auto px-0  pb-5  dark:bg-darkAccent rounded-b-3xl bg-contentBg",children:[e.jsxs("div",{className:"flex flex-col border-[1px] dark:border-darkSecondary border-lightBorderColor  rounded-lg md:mx-auto px-0 md:px-8 h-full",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center h-24",children:[e.jsxs("div",{className:"relative  z-10 ",children:[e.jsx("span",{className:"absolute top-0 bottom-0 left-3 flex items-center",children:e.jsx(ue,{className:`${S?"bg-darkIconAndSearchBg":"bg-light"}`,style:{color:"#80808f"}})}),e.jsx("input",{type:"text",className:"pl-9 py-2 w-96 dark:bg-darkIconAndSearchBg bg-light rounded-lg",placeholder:"Search..."})]}),e.jsxs("div",{className:" flex gap-2 relative",children:[e.jsx("span",{className:"relative",children:e.jsxs("button",{ref:b,onClick:()=>_(!J),type:"button",className:"btn btn-sm flex items-center px-4 py-2 bg-lightBgBtn  dark:hover:bg-darkBtnHover text-lightBtntext hover:bg-lightBtntext hover:text-white dark:bg-darkBtn dark:text-white rounded-md",children:[e.jsx(F,{className:"text-lg mr-1"}),"Shedule"]})}),e.jsx("span",{children:e.jsxs("button",{ref:b,onClick:()=>P(!T),className:" btn btn-sm flex items-center px-4 py-2 rounded-md bg-lightBgBtn dark:hover:bg-darkBtnHover text-lightBtntext hover:bg-lightBtntext hover:text-white dark:bg-darkBtn dark:text-white ",children:[e.jsx(W,{className:"text-lg mr-1"}),"Start"]})}),T?e.jsx("div",{ref:N,className:`absolute z-50 ${f?"top-[-7rem]":"top-[-4rem]"}   right-[-1rem]`,children:e.jsx("div",{className:"",children:e.jsx("div",{className:" w-[17.2rem] h-[100%] shadow-lg border border-lightborderInputColor dark:border-darkSecondary rounded-lg bg-white dark:bg-darkBtn",children:e.jsx("div",{className:"grid grid-cols-1",children:e.jsxs("div",{className:"border-t  border-lightborderInputColor   dark:border-darkSecondary",children:[e.jsx("button",{onClick:le,className:"  px-3 py-1  w-[100%] relative cursor-pointer",children:e.jsxs("div",{className:"flex py-2 flex-row items-center gap-2 rounded-lg px-2 hover:bg-lightBgBtn dark:hover:bg-lightBtntext dark:hover:text-white",children:[e.jsx("span",{className:"",children:e.jsx(we,{className:"  text-xl text-gray-700 dark:text-white"})}),e.jsx("p",{className:` ${S?"text-white":"text-black"}`,children:"New Case Sheet"})]})}),f?e.jsx("button",{onClick:ne,className:"  px-3 py-1  w-[100%] relative cursor-pointer",children:e.jsxs("div",{className:"flex flex-row items-center gap-2 px-2 py-2 rounded-lg hover:bg-lightBgBtn dark:hover:bg-lightBtntext dark:hover:text-white ",children:[e.jsx("span",{className:"",children:e.jsx(ge,{className:"  text-xl text-gray-700 dark:text-white"})}),e.jsx("p",{className:` ${S?"text-white":"text-black"}`,children:"Resume Last Case Sheet"})]})}):""]})})})})}):""]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full ",children:[e.jsx("thead",{className:"bg-[#C9FEFF] dark:bg-darkBtn dark:text-white sticky top-0",children:e.jsxs("tr",{className:"border-b border-dashed border-lighttableBorderColor",children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-semibold  tracking-wider",children:"Branch"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-semibold  tracking-wider",children:"Case ID"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-semibold  tracking-wider",children:"Patient ID"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-semibold  tracking-wider",children:"Patient Group"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-semibold  tracking-wider",children:"Duty Doctor"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-semibold  tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-semibold  tracking-wider",children:"Action"})]})}),Q?e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 h-[10rem] py-4 text-center text-sm font-medium text-gray-500 dark:text-white",children:e.jsx(G,{})})})}):e.jsx("tbody",{className:"bg-white dark:bg-darkAccent",children:B&&B.length>0?B.map((t,a)=>{var M,R,H,$,z;const s=t==null?void 0:t.status,u=(M=t==null?void 0:t.branchId)==null?void 0:M.name,i=(R=t==null?void 0:t.patientId)==null?void 0:R.displayId,c=(H=t==null?void 0:t.patientId)==null?void 0:H.patientGroup,d=(($=t==null?void 0:t.createdBy)==null?void 0:$.firstName)+" "+((z=t==null?void 0:t.createdBy)==null?void 0:z.lastName),h=t==null?void 0:t.drafted;return e.jsxs("tr",{className:"border-b border-dashed border-lighttableBorderColor",children:[e.jsx("th",{scope:"row",className:"px-6 py-4 whitespace-nowrap text-start text-sm font-medium text-tableTextColor dark:text-white",children:u&&u}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-start text-sm text-tableTextColor dark:text-white",children:t==null?void 0:t.displayId}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-start text-sm text-tableTextColor dark:text-white",children:i}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-start text-sm text-tableTextColor dark:text-white",children:c}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-start text-sm text-tableTextColor dark:text-white",children:d}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm text-tableTextColor dark:text-white",children:e.jsx("button",{disabled:!h,className:` px-2 py-1 rounded-full shadow-lg ${(()=>{switch(s){case"In Progress":return"bg-blue-200 text-white";case"Cancelled":return"bg-red-500 text-white";case"Completed":return"bg-green-800 text-white";case"Proposed":return"bg-yellow-500 text-black";default:return"bg-gray-300 text-black"}})()}`,onClick:()=>re(h,t==null?void 0:t._id),children:h?"Draft":t==null?void 0:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm text-tableTextColor",children:e.jsxs("div",{className:"flex justify-start text-lg space-x-5 rtl:space-x-reverse",children:[e.jsx(v,{content:"View",placement:"top",arrow:!0,animation:"shift-away",children:e.jsx("button",{className:"action-btn",type:"button",onClick:()=>K(h,t==null?void 0:t._id),children:e.jsx(j,{icon:"heroicons:eye"})})}),e.jsx(v,{content:"Edit",placement:"top",arrow:!0,animation:"shift-away",children:e.jsx("button",{disabled:s=="Completed",className:"action-btn",type:"button",onClick:()=>se(h,t==null?void 0:t._id),children:e.jsx(j,{icon:"heroicons:pencil-square"})})}),e.jsx(v,{content:" Delete",placement:"top",arrow:!0,animation:"shift-away",theme:"danger",children:e.jsx("button",{className:"action-btn",type:"button",onClick:()=>te(t),children:e.jsx(j,{icon:"heroicons:trash"})})}),e.jsx(v,{content:"print",placement:"top",arrow:!0,animation:"shift-away",theme:"danger",children:e.jsx("button",{className:"action-btn",type:"button",onClick:()=>ee(h,t==null?void 0:t._id),children:e.jsx(j,{icon:"heroicons:printer"})})})]})})]},a)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center text-lg font-medium text-lightModalHeaderColor",children:"NO DATA FOUND"})})})]})})]}),e.jsx(w,{appear:!0,show:X,as:n.Fragment,children:e.jsxs(C,{as:"div",className:"relative z-[99999]",onClose:Z,children:[e.jsx(w.Child,{as:n.Fragment,enter:l?"":"duration-300 ease-out",enterFrom:l?"":"opacity-0",enterTo:l?"":"opacity-100",leave:l?"":"duration-200 ease-in",leaveFrom:l?"":"opacity-100",leaveTo:l?"":"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-slate-900/50 backdrop-filter backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:`flex min-h-full justify-center text-center p-6 items-center "
                                    }`,children:e.jsx(w.Child,{as:n.Fragment,enter:l?"":"duration-300  ease-out",enterFrom:l?"":"opacity-0 scale-95",enterTo:l?"":"opacity-100 scale-100",leave:l?"":"duration-200 ease-in",leaveFrom:l?"":"opacity-100 scale-100",leaveTo:l?"":"opacity-0 scale-95",children:e.jsx(C.Panel,{className:`w-full transform overflow-hidden rounded-md
                                       bg-white dark:bg-darkSecondary text-left align-middle shadow-xl transition-alll max-w-[17rem] h-40 `,children:e.jsx("div",{className:"flex flex-col justify-center mt-20 items-center gap-2",children:e.jsx(G,{})})})})})})]})}),e.jsx(w,{appear:!0,show:Y,as:n.Fragment,children:e.jsxs(C,{as:"div",className:"relative z-[99999]",onClose:m,children:[e.jsx(w.Child,{as:n.Fragment,enter:l?"":"duration-300 ease-out",enterFrom:l?"":"opacity-0",enterTo:l?"":"opacity-100",leave:l?"":"duration-200 ease-in",leaveFrom:l?"":"opacity-100",leaveTo:l?"":"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-slate-900/50 backdrop-filter backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:`flex min-h-full w-auto justify-center text-center p-6 items-center "
                                    }`,children:e.jsx(w.Child,{as:n.Fragment,enter:l?"":"duration-300  ease-out",enterFrom:l?"":"opacity-0 scale-95",enterTo:l?"":"opacity-100 scale-100",leave:l?"":"duration-200 ease-in",leaveFrom:l?"":"opacity-100 scale-100",leaveTo:l?"":"opacity-0 scale-95",children:e.jsxs(C.Panel,{className:`w-auto transform overflow-hidden rounded-md
                                       bg-white dark:bg-darkSecondary text-left align-middle shadow-xl transition-alll  h-auto `,children:[e.jsx("div",{className:"relative overflow-hidden py-4 px-5 text-lightModalHeaderColor flex justify-end bg-white border-b border-lightBorderColor dark:bg-darkSecondary dark:border-b dark:border-darkSecondary ",children:e.jsx("button",{onClick:m,className:" text-lightmodalCrosscolor hover:bg-red-100 hover:text-lightmodalbtnText text-[22px]",children:e.jsx(j,{icon:"heroicons-outline:x"})})}),e.jsxs("div",{className:"flex flex-col justify-center mt-20 items-center gap-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{children:e.jsx("img",{className:" mx-auto",src:be,alt:""})}),e.jsx("div",{children:e.jsx("h1",{className:"text-lightBtntext text-xl pt-3",children:"Are You Sure?"})}),e.jsx("p",{className:"px-10 py-5 tex-lg dark:text-white",children:"You have an open case sheet, are you sure to close it and create a new one?"})]}),e.jsx("div",{className:"px-2 py-3 flex w-[100%] items-center  space-x-3 border-t border-slate-100 dark:border-darkSecondary",children:e.jsxs("div",{className:"flex py-5  w-[100%] justify-around gap-2",children:[e.jsx(V,{text:"Create Case Sheet",className:"btn btn-sm bg-blue-200 hover:bg-blue-500 mt-1 md:mt-2 px-4 py-2 rounded text-blue-900 hover:text-white",onClick:ce}),e.jsx(V,{text:"Resume Case Sheet",className:"btn btn-sm bg-lightBgBtn hover:bg-lightHoverBgBtn mt-1 md:mt-2 px-4 py-2 rounded text-lightBtntext hover:text-white",onClick:oe})]})})]})]})})})})]})})]})})}export{Se as default};
